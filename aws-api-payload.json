{
    "Cluster": {
        "StepConcurrencyLevel": 1,
        "TerminationProtected": false,
        "BootstrapActions": [],
        "LogUri": "s3://$S3_LOG_BUCKET/emr/analytical-dataset-generation/",
        "Tags": [
            {
                "Value": "Ignore",
                "Key": "Persistence"
            },
            {
                "Value": "dataworks platform",
                "Key": "Owner"
            },
            {
                "Value": "false",
                "Key": "has_stub_broker"
            },
            {
                "Value": "terraform",
                "Key": "CreatedBy"
            },
            {
                "Value": "True",
                "Key": "SSMEnabled"
            },
            {
                "Value": "development",
                "Key": "Environment"
            },
            {
                "Value": "true",
                "Key": "peered_with_ucfs"
            },
            {
                "Value": "aws-ingestion",
                "Key": "Application"
            },
            {
                "Value": "stub-broker",
                "Key": "k2hb_data_source"
            },
            {
                "Value": "dev-ingest-hbase-clone",
                "Key": "Name"
            }
        ],
        "Applications": [
            {
                "Version": "1.4.10",
                "Name": "HBase"
            },
            {
                "Version": "2.3.6",
                "Name": "Hive"
            },
            {
                "Version": "2.4.4",
                "Name": "Spark"
            }
        ],
        "CustomAmiId": "ami-0c659cf3b3d891800",
        "ScaleDownBehavior": "TERMINATE_AT_TASK_COMPLETION",
        "EbsRootVolumeSize": 10,
        "Ec2InstanceAttributes": {
            "ServiceAccessSecurityGroup": "$SERVICE_SG",
            "EmrManagedMasterSecurityGroup": "$MASTER_SG",
            "RequestedEc2AvailabilityZones": [],
            "AdditionalSlaveSecurityGroups": [
                "$ADD_SLAVE_SG"
            ],
            "AdditionalMasterSecurityGroups": [
                "$ADD_MASTER_SG"
            ],
            "RequestedEc2SubnetIds": [
                "$SUBNET_ID"
            ],
            "Ec2SubnetId": "$SUBNET_ID",
            "IamInstanceProfile": "$INSTANCE_PROFILE",
            "Ec2KeyName": "$EC2_KEYNAME",
            "EmrManagedSlaveSecurityGroup": "$SLAVE_SG"
        },
        "Name": "$CLUSTER_NAME",
        "ServiceRole": "$SERVICE_ROLE",
        "InstanceCollectionType": "INSTANCE_GROUP",
        "SecurityConfiguration": "$SECURITY_CONFIGURATION",
        "InstanceGroups": [
            {
                "RequestedInstanceCount": 1,
                "Name": "hbase-core",
                "InstanceGroupType": "CORE",
                "EbsBlockDevices": [
                    {
                        "Device": "/dev/sdb",
                        "VolumeSpecification": {
                            "Iops": 2000,
                            "VolumeType": "io1",
                            "SizeInGB": 384
                        }
                    }
                ],
                "ShrinkPolicy": {},
                "LastSuccessfullyAppliedConfigurations": [],
                "LastSuccessfullyAppliedConfigurationsVersion": 0,
                "ConfigurationsVersion": 0,
                "Configurations": [],
                "InstanceType": "m5.xlarge",
                "Market": "ON_DEMAND"
            },
            {
                "RequestedInstanceCount": 1,
                "Name": "hbase-master",
                "InstanceGroupType": "MASTER",
                "EbsBlockDevices": [
                    {
                        "Device": "/dev/sdb",
                        "VolumeSpecification": {
                            "Iops": 2000,
                            "VolumeType": "io1",
                            "SizeInGB": 384
                        }
                    }
                ],
                "ShrinkPolicy": {},
                "LastSuccessfullyAppliedConfigurations": [],
                "LastSuccessfullyAppliedConfigurationsVersion": 0,
                "ConfigurationsVersion": 0,
                "Configurations": [],
                "InstanceType": "m5.xlarge",
                "Market": "ON_DEMAND"
            }
        ],
        "RepoUpgradeOnBoot": "NONE",
        "AutoTerminate": false,
        "Configurations": [
            {
                "Properties": {
                    "yarn.nodemanager.remote-app-log-dir": "s3://$S3_LOG_BUCKET/emr/analytical-dataset-generation/yarn/",
                    "yarn.log-aggregation-enable": "true",
                    "yarn.log-aggregation.retain-seconds": "-1"
                },
                "Classification": "yarn-site"
            },
            {
                "Properties": {
                    "maximizeResourceAllocation": "false"
                },
                "Classification": "spark"
            },
            {
                "Properties": {
                    "spark.yarn.jars": "/usr/lib/spark/jars/*,/usr/lib/hbase/*,/usr/lib/hive/lib/hive-hbase-handler.jar,/usr/lib/hive/lib/metrics-core-2.2.0.jar,/usr/lib/hive/lib/htrace-core-3.1.0-incubating.jar",
                    "spark.executor.extraClassPath": "/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/emrfs/conf:/usr/share/aws/emr/emrfs/lib/*:/usr/share/aws/emr/emrfs/auxlib/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/usr/lib/hive/lib/hive-hbase-handler.jar:/usr/lib/hbase/*:/usr/lib/hive/lib/metrics-core-2.2.0.jar:/usr/lib/hive/lib/htrace-core-3.1.0-incubating.jar",
                    "spark.executor.extraJavaOptions": "-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=70 -XX:MaxHeapFreeRatio=70 -XX:+CMSClassUnloadingEnabled -XX:OnOutOfMemoryError='kill -9 %p' -Dhttp.proxyHost='{proxy_host}' -Dhttp.proxyPort='3128' -Dhttp.nonProxyHosts='instance-data.$REGION.compute.internal|*.s3.$REGION.amazonaws.com|s3.$REGION.amazonaws.com|sns.$REGION.amazonaws.com|sqs.$REGION.amazonaws.com|$REGION.queue.amazonaws.com|glue.$REGION.amazonaws.com|sts.$REGION.amazonaws.com|*.$REGION.compute.internal|dynamodb.$REGION.amazonaws.com' -Dhttps.proxyHost='{proxy_host}' -Dhttps.proxyPort='3128'",
                    "spark.yarn.dist.files": "/etc/spark/conf/hive-site.xml,/etc/hbase/conf/hbase-site.xml",
                    "spark.driver.extraJavaOptions": "-XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=70 -XX:MaxHeapFreeRatio=70 -XX:+CMSClassUnloadingEnabled -XX:OnOutOfMemoryError='kill -9 %p' -Dhttp.proxyHost='{proxy_host}' -Dhttp.proxyPort='3128' -Dhttp.nonProxyHosts='instance-data.$REGION.compute.internal|*.s3.$REGION.amazonaws.com|s3.$REGION.amazonaws.com|sns.$REGION.amazonaws.com|sqs.$REGION.amazonaws.com|$REGION.queue.amazonaws.com|glue.$REGION.amazonaws.com|sts.$REGION.amazonaws.com|*.$REGION.compute.internal|dynamodb.$REGION.amazonaws.com' -Dhttps.proxyHost='{proxy_host}' -Dhttps.proxyPort='3128'",
                    "spark.driver.extraClassPath": "/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/emrfs/conf:/usr/share/aws/emr/emrfs/lib/*:/usr/share/aws/emr/emrfs/auxlib/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/usr/lib/hive/lib/hive-hbase-handler.jar:/usr/lib/hbase/*:/usr/lib/hive/lib/metrics-core-2.2.0.jar:/usr/lib/hive/lib/htrace-core-3.1.0-incubating.jar",
                    "spark.sql.warehouse.dir": "s3://$S3_PUBLISH_BUCKET/analytical-dataset/data/external",
                    "spark.sql.catalogImplementation": "hive"
                },
                "Classification": "spark-defaults"
            },
            {
                "Properties": {
                    "hive.metastore.client.factory.class": "com.amazonaws.glue.catalog.metastore.AWSGlueDataCatalogHiveClientFactory"
                },
                "Classification": "spark-hive-site"
            },
            {
                "Properties": {
                    "hive.metastore.schema.verification": "false",
                    "hive.metastore.client.factory.class": "com.amazonaws.glue.catalog.metastore.AWSGlueDataCatalogHiveClientFactory",
                    "hive.metastore.warehouse.dir": "s3://$S3_PUBLISH_BUCKET/analytical-dataset/hive/external"
                },
                "Classification": "hive-site"
            },
            {
                "Properties": {
                    "hbase.server.keyvalue.maxsize": "750000000",
                    "hbase.bulkload.retries.retryOnIOException": "true",
                    "hbase.client.keyvalue.maxsize": "750000000",
                    "hbase.client.write.buffer": "8388608",
                    "hbase.bucketcache.bucket.sizes": "5120,9216,17408,33792,41984,50176,58368,66560,99328,132096,197632,263168,394240,525312,656384,787456,918528,1049600,1180672,1311744,1442816,1704960,1967104,2229248",
                    "hbase.rootdir": "${hbase_root_path}",
                    "hbase.regionserver.handler.count": "4"
                },
                "Classification": "hbase-site"
            },
            {
                "Properties": {
                    "hbase.emr.storageMode": "s3",
                    "hbase.emr.readreplica.enabled": "true"
                },
                "Classification": "hbase"
            },
            {
                "Properties": {
                    "fs.s3.cse.materialsDescription.enabled": "true"
                },
                "Classification": "emrfs-site"
            }
        ],
        "ReleaseLabel": "emr-5.24.1",
        "NormalizedInstanceHours": 16,
        "KerberosAttributes": {},
        "VisibleToAllUsers": true
    }
}